<div class="set-password-container">
  
  <!-- Logo Section -->
  <div class="logo-section">
    <div class="logo-icon">
      <img src="../../../assets/logo2-while-2 1.png" alt="Clarium Logo" />
    </div>
  </div>

  <!-- Set New Password Card -->
  <div class="set-password-card">
    <h2>Set New Password</h2>
    <p class="subtitle">
      Create a strong password for<br>
      <strong>{{ email }}</strong>
    </p>

    <div *ngIf="successMessage" class="success-msg">
      {{ successMessage }}
    </div>

    <div *ngIf="errorMessage" class="error-msg">
      {{ errorMessage }}
    </div>

    <form (ngSubmit)="onSubmit()" #setPasswordForm="ngForm">
      <!-- New Password Field -->
      <div class="input-box">
        <label>New Password</label>
        <input 
          [type]="showPassword ? 'text' : 'password'"
          name="newPassword" 
          [(ngModel)]="newPassword" 
          required 
          minlength="6"
          placeholder="Enter your new password"
        />
        <span class="icon toggle-password" (click)="togglePasswordVisibility()">
          <ion-icon [name]="showPassword ? 'eye-off' : 'eye'"></ion-icon>
        </span>
      </div>

      <!-- Password Strength Indicator -->
      <div *ngIf="newPassword" class="password-strength">
        <div class="strength-bar">
          <div [class]="'strength-fill ' + getPasswordStrengthClass()"></div>
        </div>
        <p class="strength-text" [class]="getPasswordStrengthClass()">
          Password Strength: {{ getPasswordStrengthText() }}
        </p>
      </div>

      <!-- Confirm Password Field -->
      <div class="input-box">
        <label>Confirm Password</label>
        <input 
          [type]="showConfirmPassword ? 'text' : 'password'"
          name="confirmPassword" 
          [(ngModel)]="confirmPassword" 
          required 
          minlength="6"
          placeholder="Confirm your new password"
        />
        <span class="icon toggle-password" (click)="toggleConfirmPasswordVisibility()">
          <ion-icon [name]="showConfirmPassword ? 'eye-off' : 'eye'"></ion-icon>
        </span>
      </div>

      <!-- Password Requirements -->
      <div class="password-requirements">
        <p class="requirements-title">Password must contain:</p>
        <ul>
          <li [class.met]="hasMinLength()">
            <ion-icon [name]="getRequirementIcon(hasMinLength())"></ion-icon>
            At least 6 characters
          </li>
          <li [class.met]="hasUpperAndLowerCase()">
            <ion-icon [name]="getRequirementIcon(hasUpperAndLowerCase())"></ion-icon>
            Upper and lowercase letters
          </li>
          <li [class.met]="hasNumber()">
            <ion-icon [name]="getRequirementIcon(hasNumber())"></ion-icon>
            At least one number
          </li>
        </ul>
      </div>

      <button type="submit" [disabled]="!setPasswordForm.form.valid || isSubmitting || newPassword !== confirmPassword">
        {{ isSubmitting ? 'Resetting Password...' : 'Reset Password' }}
      </button>
    </form>

    <div class="back-to-login">
      <a [routerLink]="['/login']">
        <ion-icon name="arrow-back"></ion-icon>
        Back to Login
      </a>
    </div>
  </div>

</div>