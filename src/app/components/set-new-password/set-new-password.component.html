<div class="set-password-container">
    <div class="set-password-box">
      <div class="set-password-card">
        <h2>Set New Password</h2>
        <p class="subtitle">
          Create a strong password for<br>
          <strong>{{ email }}</strong>
        </p>
  
        <div *ngIf="successMessage" class="success-msg">
          {{ successMessage }}
        </div>
  
        <div *ngIf="errorMessage" class="error-msg">
          {{ errorMessage }}
        </div>
  
        <form (ngSubmit)="onSubmit()" #setPasswordForm="ngForm">
          <!-- New Password Field -->
          <div class="input-box">
            <input 
              [type]="showPassword ? 'text' : 'password'"
              name="newPassword" 
              [(ngModel)]="newPassword" 
              required 
              minlength="6"
              placeholder=" "
            />
            <label>New Password</label>
            <span class="icon toggle-password" (click)="togglePasswordVisibility()">
              <ion-icon [name]="showPassword ? 'eye-off' : 'eye'"></ion-icon>
            </span>
          </div>
  
          <!-- Password Strength Indicator -->
          <div *ngIf="newPassword" class="password-strength">
            <div class="strength-bar">
              <div [class]="'strength-fill ' + getPasswordStrengthClass()"></div>
            </div>
            <p class="strength-text" [class]="getPasswordStrengthClass()">
              Password Strength: {{ getPasswordStrengthText() }}
            </p>
          </div>
  
          <!-- Confirm Password Field -->
          <div class="input-box">
            <input 
              [type]="showConfirmPassword ? 'text' : 'password'"
              name="confirmPassword" 
              [(ngModel)]="confirmPassword" 
              required 
              minlength="6"
              placeholder=" "
            />
            <label>Confirm Password</label>
            <span class="icon toggle-password" (click)="toggleConfirmPasswordVisibility()">
              <ion-icon [name]="showConfirmPassword ? 'eye-off' : 'eye'"></ion-icon>
            </span>
          </div>
  
          <!-- Password Requirements -->
          <div class="password-requirements">
            <p class="requirements-title">Password must contain:</p>
            <ul>
              <li [class.met]="hasMinLength()">
                <ion-icon [name]="getRequirementIcon(hasMinLength())"></ion-icon>
                At least 6 characters
              </li>
              <li [class.met]="hasUpperAndLowerCase()">
                <ion-icon [name]="getRequirementIcon(hasUpperAndLowerCase())"></ion-icon>
                Upper and lowercase letters
              </li>
              <li [class.met]="hasNumber()">
                <ion-icon [name]="getRequirementIcon(hasNumber())"></ion-icon>
                At least one number
              </li>
            </ul>
          </div>
  
          <button type="submit" [disabled]="!setPasswordForm.form.valid || isSubmitting || newPassword !== confirmPassword">
            {{ isSubmitting ? 'Resetting Password...' : 'Reset Password' }}
          </button>
        </form>
  
        <div class="back-to-login">
          <a [routerLink]="['/login']">
            <ion-icon name="arrow-back"></ion-icon>
            Back to Login
          </a>
        </div>
      </div>
    </div>
  </div>